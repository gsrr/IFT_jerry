a:180:{i:0;a:3:{i:0;s:14:"document_start";i:1;a:0:{}i:2;i:0;}i:1;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:9:"Reference";i:1;i:1;i:2;i:1;}i:2;i:1;}i:2;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:1;}i:2;i:1;}i:3;a:3:{i:0;s:4:"file";i:1;a:3:{i:0;s:142:"
# Setting up Samba as a Domain Member
https://wiki.samba.org/index.php/Setting_up_Samba_as_a_Domain_Member#Testing_the_Winbindd_Connectivity
";i:1;N;i:2;N;}i:2;i:30;}i:4;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:182;}i:5;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:23:"Event and Error message";i:1;i:1;i:2;i:182;}i:2;i:182;}i:6;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:1;}i:2;i:182;}i:7;a:3:{i:0;s:10:"table_open";i:1;a:3:{i:0;i:5;i:1;i:9;i:2;i:220;}i:2;i:219;}i:8;a:3:{i:0;s:13:"tablerow_open";i:1;a:0:{}i:2;i:219;}i:9;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:219;}i:10;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:221;}i:11;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:222;}i:12;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:222;}i:13;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:223;}i:14;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:224;}i:15;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:224;}i:16;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:7:"message";}i:2;i:225;}i:17;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:232;}i:18;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:232;}i:19;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:5:"event";}i:2;i:233;}i:20;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:238;}i:21;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:238;}i:22;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:239;}i:23;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:240;}i:24;a:3:{i:0;s:14:"tablerow_close";i:1;a:0:{}i:2;i:241;}i:25;a:3:{i:0;s:13:"tablerow_open";i:1;a:0:{}i:2;i:241;}i:26;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:241;}i:27;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:2:"AD";}i:2;i:243;}i:28;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:245;}i:29;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:245;}i:30;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:50:"Password / Accout Error (Preauthentication failed)";}i:2;i:246;}i:31;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:296;}i:32;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:296;}i:33;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:37:" 使用者名稱或密碼不正確。";}i:2;i:297;}i:34;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:334;}i:35;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:334;}i:36;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:3:" X ";}i:2;i:335;}i:37;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:338;}i:38;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:338;}i:39;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:339;}i:40;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:340;}i:41;a:3:{i:0;s:14:"tablerow_close";i:1;a:0:{}i:2;i:341;}i:42;a:3:{i:0;s:13:"tablerow_open";i:1;a:0:{}i:2;i:341;}i:43;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:341;}i:44;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:2:"AD";}i:2;i:343;}i:45;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:345;}i:46;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:345;}i:47;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:43:" Dns Entry error (Can not find KDC Server) ";}i:2;i:346;}i:48;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:389;}i:49;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;s:5:"right";i:2;i:1;}i:2;i:389;}i:50;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:4:"  X ";}i:2;i:390;}i:51;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:394;}i:52;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:394;}i:53;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:3:" X ";}i:2;i:395;}i:54;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:398;}i:55;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:398;}i:56;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:399;}i:57;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:400;}i:58;a:3:{i:0;s:14:"tablerow_close";i:1;a:0:{}i:2;i:401;}i:59;a:3:{i:0;s:13:"tablerow_open";i:1;a:0:{}i:2;i:401;}i:60;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:401;}i:61;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:2:"AD";}i:2;i:403;}i:62;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:405;}i:63;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:405;}i:64;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:37:" ip error (Can't contact LDAP server)";}i:2;i:406;}i:65;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:443;}i:66;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;s:4:"left";i:2;i:1;}i:2;i:443;}i:67;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:33:" 無法連到網域伺務器。  ";}i:2;i:444;}i:68;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:477;}i:69;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:477;}i:70;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:3:" X ";}i:2;i:478;}i:71;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:481;}i:72;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:481;}i:73;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:482;}i:74;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:483;}i:75;a:3:{i:0;s:14:"tablerow_close";i:1;a:0:{}i:2;i:484;}i:76;a:3:{i:0;s:13:"tablerow_open";i:1;a:0:{}i:2;i:484;}i:77;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:484;}i:78;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:2:"AD";}i:2;i:486;}i:79;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:488;}i:80;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:488;}i:81;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:127:" account 沒有admin 權限 ( Failed to join domain: Failed to set account flags for machine account (NT_STATUS_ACCESS_DENIED))";}i:2;i:489;}i:82;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:616;}i:83;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;s:4:"left";i:2;i:1;}i:2;i:616;}i:84;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:4:" X  ";}i:2;i:617;}i:85;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:621;}i:86;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:621;}i:87;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:3:" X ";}i:2;i:622;}i:88;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:625;}i:89;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:625;}i:90;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:626;}i:91;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:627;}i:92;a:3:{i:0;s:14:"tablerow_close";i:1;a:0:{}i:2;i:628;}i:93;a:3:{i:0;s:13:"tablerow_open";i:1;a:0:{}i:2;i:628;}i:94;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:628;}i:95;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:4:"LDAP";}i:2;i:630;}i:96;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:634;}i:97;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:634;}i:98;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:43:" Password (ldap_bind: Invalid credentials) ";}i:2;i:635;}i:99;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:678;}i:100;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;s:4:"left";i:2;i:1;}i:2;i:678;}i:101;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:39:" 使用者名稱或密碼不正確。  ";}i:2;i:679;}i:102;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:718;}i:103;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:718;}i:104;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:3:" X ";}i:2;i:719;}i:105;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:722;}i:106;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:722;}i:107;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:723;}i:108;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:724;}i:109;a:3:{i:0;s:14:"tablerow_close";i:1;a:0:{}i:2;i:725;}i:110;a:3:{i:0;s:13:"tablerow_open";i:1;a:0:{}i:2;i:725;}i:111;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:725;}i:112;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:4:"LDAP";}i:2;i:727;}i:113;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:731;}i:114;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:731;}i:115;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:48:" User Dn error (ldap_bind: Invalid credentials) ";}i:2;i:732;}i:116;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:780;}i:117;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:780;}i:118;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:38:" 使用者名稱或密碼不正確。 ";}i:2;i:781;}i:119;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:819;}i:120;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:819;}i:121;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:3:" X ";}i:2;i:820;}i:122;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:823;}i:123;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:823;}i:124;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:824;}i:125;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:825;}i:126;a:3:{i:0;s:14:"tablerow_close";i:1;a:0:{}i:2;i:826;}i:127;a:3:{i:0;s:13:"tablerow_open";i:1;a:0:{}i:2;i:826;}i:128;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:826;}i:129;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:4:"LDAP";}i:2;i:828;}i:130;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:832;}i:131;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:832;}i:132;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:39:" ip error (can not contact ldap server)";}i:2;i:833;}i:133;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:872;}i:134;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:872;}i:135;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:30:" 無法連接到LDAP伺服器 ";}i:2;i:873;}i:136;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:903;}i:137;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:903;}i:138;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:3:" X ";}i:2;i:904;}i:139;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:907;}i:140;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:907;}i:141;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:908;}i:142;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:909;}i:143;a:3:{i:0;s:14:"tablerow_close";i:1;a:0:{}i:2;i:910;}i:144;a:3:{i:0;s:13:"tablerow_open";i:1;a:0:{}i:2;i:910;}i:145;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:910;}i:146;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:4:"LDAP";}i:2;i:912;}i:147;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:916;}i:148;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:916;}i:149;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:31:" Base Dn error (No such object)";}i:2;i:917;}i:150;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:948;}i:151;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:948;}i:152;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:3:" X ";}i:2;i:949;}i:153;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:952;}i:154;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:952;}i:155;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:3:" X ";}i:2;i:953;}i:156;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:956;}i:157;a:3:{i:0;s:14:"tablecell_open";i:1;a:3:{i:0;i:1;i:1;N;i:2;i:1;}i:2;i:956;}i:158;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:957;}i:159;a:3:{i:0;s:15:"tablecell_close";i:1;a:0:{}i:2;i:958;}i:160;a:3:{i:0;s:14:"tablerow_close";i:1;a:0:{}i:2;i:959;}i:161;a:3:{i:0;s:11:"table_close";i:1;a:1:{i:0;i:959;}i:2;i:959;}i:162;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:965;}i:163;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:3:"acl";i:1;i:1;i:2;i:965;}i:2;i:965;}i:164;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:1;}i:2;i:965;}i:165;a:3:{i:0;s:4:"file";i:1;a:3:{i:0;s:2415:"
# user join group after login
## gs-join group-ad
1. user1 login samba
2. join group (ad)
3. without update user list
ret --> can not access share folder (without relogin)
relogin --> can access share folder

[root@nas_8446485_a ~]# id WINADNTP\\test001
uid=11001369(WINADNTP\test001) gid=11000513(WINADNTP\domain users) groups=11001369(WINADNTP\test001),11000513(WINADNTP\domain users),11001372(WINADNTP\group002)

## gs-join group-ad
1. user1 login samba
2. join group (ad)
3. without update user list
ret --> can not access share folder (without relogin)
relogin --> can access share folder

[root@nas_8446485_a ~]# id WINADNTP\\test001
uid=11001369(WINADNTP\test001) gid=11000513(WINADNTP\domain users) groups=11001369(WINADNTP\test001),11000513(WINADNTP\domain users),11001372(WINADNTP\group002)

## gs-join group-ad
1. user1 login samba
2. user1 join group
3. update user list 
ret --> can not access share folder 
relogin --> can access share folder

## gs without re-login
1. user1 login samba
2. user1 join group (ad)
3. update user list
ret -->

## gs without re-login
1. user1 login samba
2. user1 join group (ad)
3. without update user list
ret --> 
relogin --> 

## gs-join group-ldap
1. user1 login samba
2. user1 join group
3. without update user list 
ret --> can not access share folder (without relogin)
relogin --> can not access share folder

## gs-join group-ldap
1. user1 login samba
2. user1 join group
3. update user list 
ret --> can not access share folder (without relogin)
relogin --> can access share folder

## gs-leave group-ldap
1. user1 login samba
2. user1 leave group
3. without update user list 
ret --> can access share folder (without relogin)
relogin --> can access share folder

## gs-leave group-ldap
1. user1 login samba
2. user1 leave group
3. update user list 
ret --> can access share folder (without relogin)
relogin --> can not can access share folder

## synology without re-login
1. user1 login samba
2. join group
3. waiting time (check user list)
ret --> 


Summary:
1. 一定要重新login才會生效, 不論有update user or not. (nscd -i group)
2. ad跟ldap的行為不太一樣, ad的id command似乎沒有辦法再nscd -i group就更新, 必須要重新login
3. ad只要重新login, 其acl就可以生效, 即便id user沒有更新也沒關係.
3. synology 在add group時, 似乎可以不用重新login, 但leave group時等了15分鐘還是可以操作.

";i:1;N;i:2;N;}i:2;i:988;}i:166;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:3414;}i:167;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:12:"AD take over";i:1;i:1;i:2;i:3414;}i:2;i:3414;}i:168;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:1;}i:2;i:3414;}i:169;a:3:{i:0;s:4:"file";i:1;a:3:{i:0;s:1677:"
172.27.120.180 WIN-2012R2ADC.winadntp.evt
172.27.120.179 WIN-2012R2ADNTP.winadntp.evt
# join AD message
Using short domain name -- WINADNTP
5433 Joined 'NAS_824366_A' to dns domain 'winadntp.evt'
5434 No DNS domain configured for nas_824366_a. Unable to perform DNS Update.)
--> normal message

# failed to join AD
Mar 27 02:42:12 nas_824366_a ldapOperation[2449]: (cmd, out) = (['/usr/bin/net', 'ads', 'join', '-S', 'WIN-2012R2ADC.winadntp.evt', '-U', 'administrator%ABcd_1234', '-s', '/etc/samba/net_smb.conf'], Failed to join domain: Failed to set
machine spn: Constraint violation Do you have sufficient permissions to create machine accounts?)
Mar 27 02:42:12 nas_824366_a diagnosticOperation[2449]: {'status': 71, 'err': '', 'out': 'Failed to join domain: Failed to set machine spn: Constraint violation\nDo you have sufficient permissions to create machine accounts?'}
--> Delete the computer account of AD

Root Cause:
若A, B兩台機器, A join完斷線, 這時候會換join B來進行接手,此時新增加的computer object id與join A時並不一樣,
所以當A起來後, 會多出一個computerCNF的object, 導致若要換成joinA接手時會失敗.

# 另外一個問題是沒辦法透過DNS找不到ip
--> 看起來是因為找到192.168.99.14去了, 導致DNS會一直回覆unknown host.
anyway , 目前測試起來, 應該不需要進行重新join的動作.
只要透過wbinfo -P來讓winbind ping AD, 就可以讓winbind建立正確連線.

test scope:
1. DNS應該只保留查詢得到的nameserver. (192.168.99.14, 192.168.99.16都應該去除)
2. 將AD斷線, 等待約5~10分鐘, 再重新使用AD user來登入samba, 確認該user可以正常登入.

";i:1;N;i:2;N;}i:2;i:3446;}i:170;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:5132;}i:171;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:19:"AD related commands";i:1;i:1;i:2;i:5132;}i:2;i:5132;}i:172;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:1;}i:2;i:5132;}i:173;a:3:{i:0;s:4:"file";i:1;a:3:{i:0;s:580:"
# smbd
1. port 139, port 445

# nmbd
1. port 137, port 138
UDP    172.27.12.71:137       *:*                                    4
UDP    172.27.12.71:138       *:*                                    4

# search workgroup
1. net ads workgroup -S 172.27.120.130
2. nmblookup -A 172.27.l20.130
3. 

# join AD
net ads join -U administrator%ABcd1234

# leave AD
net ads leave -U administrator%ABcd1234

# join specific AD
net ads join -S WIN-2012R2ADC.winadntp.evt -U administrator%ABcd_1234

# leave specific AD
net ads leave -S WIN-2012R2ADC.winadntp.evt -U administrator%ABcd_1234
";i:1;N;i:2;N;}i:2;i:5171;}i:174;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:5761;}i:175;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:13:"Error Message";i:1;i:1;i:2;i:5761;}i:2;i:5761;}i:176;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:1;}i:2;i:5761;}i:177;a:3:{i:0;s:4:"file";i:1;a:3:{i:0;s:1233:"
# can not get user information (MIS , England)
getent group : 3m40 + 3m37

# failed to join AD
Failed to join domain: failed to join domain 'WINADNTP.EVT' over rpc: None of the information to be translated has been translated.
--> Delete the computer account of AD

# failed to join AD
[root@nas_8686288_a ~]# net ads join -U administrator%ABcd_1234 -s /etc/samba/net_smb.conf
Failed to join domain: Invalid configuration ("workgroup" set to '', should be 'WINADNTP') and configuration modification was not requested
--> nmblookup -A ip , 沒辦法得到group information?
Ans : 
看起來是客戶將netbios over tcp/ip這個service關掉了, 導致nmblookup -A ip 沒有辦法得到資訊.
打開的方式如下: 
http://172.27.12.189/jerryg/lib/exe/fetch.php?media=netbios_over_tcpip.png

# failed to join AD (not have admin privilege)
n  1 15:47:21 mlmlpppnt03_a ldapOperation[1318]: joinAD result: {'status': 71, 'err': '', 'out': 'Failed to join domain: User specified does not have administrator privileges'}

# account error
joinAD result: {'status': 71, 'err': '', 'out': "Failed to join domain: failed to lookup DC info for domain 'VCPILTPAC.COM' over rpc: Account locked out"}
--> 看起來是帳號沒有辦法使用.?

";i:1;N;i:2;N;}i:2;i:5794;}i:178;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:7036;}i:179;a:3:{i:0;s:12:"document_end";i:1;a:0:{}i:2;i:7036;}}